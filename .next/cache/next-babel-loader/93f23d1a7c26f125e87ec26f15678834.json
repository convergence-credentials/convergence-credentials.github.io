{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport { get, some, sortBy } from \"lodash\";\nimport DetailedCertificateVerifyBlock from \"./DetailedCertificateVerifyBlock\";\nimport { LOG_LEVEL } from \"./constants\";\nimport css from \"./certificateVerifyBlock.scss\";\nimport icons from \"../ViewerPageImages\";\n\nconst statusSummary = ({\n  verifying,\n  hashStatus,\n  issuedStatus,\n  notRevokedStatus,\n  issuerIdentityStatus\n}) => {\n  if (verifying) return LOG_LEVEL.VERIFYING;\n  if (!verifying && hashStatus.verified && issuedStatus.verified && notRevokedStatus.verified && issuerIdentityStatus.verified) return LOG_LEVEL.VALID;\n  if (!verifying && hashStatus.verified && issuedStatus.verified && notRevokedStatus.verified && !issuerIdentityStatus.verified) return LOG_LEVEL.WARNING;\n  return LOG_LEVEL.INVALID;\n};\n\nconst renderIcon = status => {\n  let icon;\n\n  switch (status) {\n    case LOG_LEVEL.CONNECTING:\n    case LOG_LEVEL.VERIFYING:\n      icon = __jsx(\"i\", {\n        id: \"verify-spinner\",\n        className: \"fa fa-spinner fa-spin fa-2x\"\n      });\n      break;\n\n    case LOG_LEVEL.VALID:\n      icon = icons.checkCircle();\n      break;\n\n    case LOG_LEVEL.WARNING:\n      icon = __jsx(\"i\", {\n        id: \"verify-warning\",\n        className: \"fas fa-exclamation-triangle fa-2x\"\n      });\n      break;\n\n    default:\n      icon = __jsx(\"i\", {\n        id: \"verify-invalid\",\n        className: \"fas fa-times-circle fa-2x\"\n      });\n  }\n\n  return __jsx(\"div\", {\n    className: `d-flex justify-content-center align-items-center ${css[\"verified-icon\"]}`\n  }, icon);\n};\n\nexport const getIdentityVerificationText = identityStatus => {\n  if (some(identityStatus, ({\n    registry\n  }) => !!registry)) {\n    return \"Accredited by SSG\";\n  } // note filter Boolean is to remove empty values\n\n\n  const dnsNames = sortBy(identityStatus, [\"dns\"]).map(({\n    dns\n  }) => dns ? dns.toUpperCase() : null).filter(Boolean);\n  return `Issued by ${dnsNames.length > 0 ? dnsNames[0] : \"Unknown\"}`;\n};\n\nconst renderText = (status, props) => {\n  let text;\n\n  switch (status) {\n    case LOG_LEVEL.CONNECTING:\n      text = \"Connecting ...\";\n      break;\n\n    case LOG_LEVEL.VERIFYING:\n      text = \"Verifying Certificate ...\";\n      break;\n\n    case LOG_LEVEL.VALID:\n      {\n        const identity = get(props, \"issuerIdentityStatus.identities\", []);\n        text = getIdentityVerificationText(identity);\n        break;\n      }\n\n    case LOG_LEVEL.WARNING:\n      text = \"Institution identity not verified\";\n      break;\n\n    default:\n      text = \"Invalid Certificate\";\n  }\n\n  return __jsx(\"div\", {\n    className: css[\"verification-text\"]\n  }, text);\n};\n\nconst SimpleVerifyBlock = props => {\n  const status = statusSummary(props);\n  const renderedIcon = renderIcon(status);\n  const renderedText = renderText(status, props);\n  let stateStyle;\n\n  switch (status) {\n    case LOG_LEVEL.VALID:\n      stateStyle = \"valid\";\n      break;\n\n    case LOG_LEVEL.WARNING:\n      stateStyle = \"warning\";\n      break;\n\n    case LOG_LEVEL.INVALID:\n    default:\n      stateStyle = \"invalid\";\n  }\n\n  return __jsx(\"div\", {\n    className: `p-2 pointer ${css[\"simple-verify-block\"]} ${css[stateStyle]} ${props.detailedVerifyVisible ? css.active : \"\"}`,\n    onClick: props.toggleDetailedView,\n    id: \"certificate-status\"\n  }, __jsx(\"div\", {\n    className: \"row\",\n    style: {\n      flexWrap: \"inherit\"\n    }\n  }, renderedIcon, renderedText, __jsx(\"span\", {\n    // eslint-disable-next-line prettier/prettier\n    className: `d-flex justify-content-center align-items-center ${css.arrow}`\n  }, icons.arrow())));\n};\n\nconst CertificateVerifyBlock = props => {\n  const status = statusSummary(props);\n  return __jsx(\"div\", {\n    id: \"certificate-verify-block\",\n    className: `align-items-start flex-nowrap ${css[\"d-flex\"]} ${css.verifyBlocksContainer} mb-md-0 mb-3`\n  }, __jsx(SimpleVerifyBlock, props), props.detailedVerifyVisible ? __jsx(DetailedCertificateVerifyBlock, {\n    statusSummary: status,\n    hashStatus: props.hashStatus,\n    issuedStatus: props.issuedStatus,\n    notRevokedStatus: props.notRevokedStatus,\n    issuerIdentityStatus: props.issuerIdentityStatus\n  }) : \"\");\n};\n\nexport default CertificateVerifyBlock;","map":null,"metadata":{},"sourceType":"module"}